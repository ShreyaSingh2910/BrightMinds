<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anatomy Scanner â€“ Science Spotter</title>

  <script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/lottie-web/build/player/lottie.min.js"></script>
  <link rel="stylesheet" href="humanbody.css">
</head>

<body>

  <h2 class="game-title">ðŸ§¬ Anatomy Scanner</h2>
  <p class="game-instruction">
    Drag and drop the organs to their correct positions in the human body.
  </p>

  <div id="lottie-left" class="corner-lottie left-lottie"></div>
  <div id="lottie-right" class="corner-lottie right-lottie"></div>

  <div class="diagram-area">
    <div class="image-container">
      <img src="assets/body.jpeg" class="body-img" />

      <div class="label-wrapper" id="pos-1"><div class="drop-zone" data-target="brain">?</div></div>
      <div class="label-wrapper" id="pos-2"><div class="drop-zone" data-target="lungs">?</div></div>
      <div class="label-wrapper" id="pos-3"><div class="drop-zone" data-target="heart">?</div></div>
      <div class="label-wrapper" id="pos-4"><div class="drop-zone" data-target="liver">?</div></div>
      <div class="label-wrapper" id="pos-5"><div class="drop-zone" data-target="stomach">?</div></div>
      <div class="label-wrapper" id="pos-6"><div class="drop-zone" data-target="kidneys">?</div></div>
      <div class="label-wrapper" id="pos-7"><div class="drop-zone" data-target="large intestine">?</div></div>
      <div class="label-wrapper" id="pos-8"><div class="drop-zone" data-target="small intestine">?</div></div>
    </div>
  </div>

  <div class="parts-bin">
    <div class="draggable" draggable="true" id="brain">Brain</div>
    <div class="draggable" draggable="true" id="lungs">Lungs</div>
    <div class="draggable" draggable="true" id="heart">Heart</div>
    <div class="draggable" draggable="true" id="liver">Liver</div>
    <div class="draggable" draggable="true" id="stomach">Stomach</div>
    <div class="draggable" draggable="true" id="kidneys">Kidneys</div>
    <div class="draggable" draggable="true" id="large intestine">Large Intestine</div>
    <div class="draggable" draggable="true" id="small intestine">Small Intestine</div>
  </div>

  <!-- ðŸŽ‰ Congrats Modal -->
  <div id="congrats-modal" class="modal hidden">
    <div class="modal-card">
      <div id="lottie-success" class="success-lottie"></div>
      <h2>ðŸŽ‰ Amazing!</h2>
      <p>You placed all organs correctly!</p>
      <div class="modal-buttons">
        <button onclick="restartGame()">Replay</button>
        <button onclick="goBack()">Back</button>
      </div>
    </div>
  </div>

<script>
const bgSound = new Audio('assets/sounds/background.mp3');
const correctSound = new Audio('assets/sounds/correctans.mp3');
const wrongSound = new Audio('assets/sounds/wrongans.mp3');

bgSound.loop = true;
bgSound.volume = 0.3;
correctSound.volume = 1;
wrongSound.volume = 1;

document.addEventListener('pointerdown', () => {
  if (bgSound.paused) bgSound.play().catch(() => {});
}, { once: true });

let correctCount = 0;
const totalParts = document.querySelectorAll('.drop-zone').length;

const draggables = document.querySelectorAll('.draggable');
const dropZones = document.querySelectorAll('.drop-zone');

draggables.forEach(d => {
  d.addEventListener('dragstart', () => d.classList.add('dragging'));
  d.addEventListener('dragend', () => d.classList.remove('dragging'));
});

dropZones.forEach(zone => {
  zone.addEventListener('dragover', e => e.preventDefault());

  zone.addEventListener('drop', e => {
    e.preventDefault();

    const dragged = document.querySelector('.dragging');
    if (!dragged) return;

    const draggedId = dragged.id.toLowerCase();
    const targetValue = zone.dataset.target.toLowerCase();

    if (draggedId === targetValue && !zone.classList.contains('filled')) {

      correctSound.currentTime = 0;
      correctSound.play();

      zone.innerText = dragged.innerText;
      zone.classList.add('filled');
      dragged.style.display = 'none';

      correctCount++;

      gsap.from(zone, {
        scale: 1.3,
        duration: 0.4,
        ease: "back.out(2)"
      });

      if (correctCount === totalParts) {
        setTimeout(showCongrats, 600);
        bgSound.pause();
      }

    } else {
      wrongSound.currentTime = 0;
      wrongSound.play();

      gsap.to(zone, {
        x: 10,
        repeat: 3,
        yoyo: true,
        duration: 0.06
      });
    }
  });
});

lottie.loadAnimation({
  container: document.getElementById('lottie-left'),
  renderer: 'svg',
  loop: true,
  autoplay: true,
  path: 'lottie/student.json'
});

lottie.loadAnimation({
  container: document.getElementById('lottie-right'),
  renderer: 'svg',
  loop: true,
  autoplay: true,
  path: 'lottie/Funnybrain.json'
});

const successAnim = lottie.loadAnimation({
  container: document.getElementById('lottie-success'),
  renderer: 'svg',
  loop: false,
  autoplay: false,
  path: 'lottie/anim1.json'
});
function showCongrats() {
  document.getElementById('congrats-modal').classList.remove('hidden');
  successAnim.play();
}

function restartGame() {
  bgSound.pause();
  bgSound.currentTime = 0;
  location.reload();
}

function goBack() {
  bgSound.pause();
  window.location.href = "topic.html";
}
</script>

</body>
</html>

